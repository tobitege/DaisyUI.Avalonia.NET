<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="clr-namespace:Flowery.Controls;assembly=Flowery.NET">

    <Design.PreviewWith>
        <Border Padding="0" Width="400" Height="300">
             <controls:DaisyDrawer IsPaneOpen="True">
                 <controls:DaisyDrawer.Pane>
                     <StackPanel Margin="20">
                         <TextBlock Text="Sidebar Item 1" />
                         <TextBlock Text="Sidebar Item 2" />
                     </StackPanel>
                 </controls:DaisyDrawer.Pane>
                 <Grid Background="White">
                     <TextBlock Text="Main Content" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                 </Grid>
             </controls:DaisyDrawer>
        </Border>
    </Design.PreviewWith>

    <ControlTheme x:Key="{x:Type controls:DaisyDrawer}" TargetType="controls:DaisyDrawer">
        <!-- SplitView template is complex, usually we inherit standard one but just change background colors.
             Avalonia's default SplitView is unstyled or very basic.
             DaisyUI drawer has a dark overlay (scrim) and a side panel. -->
        <Setter Property="PaneBackground" Value="{DynamicResource DaisyBase100Brush}" />

        <!-- We can just rely on default SplitView template if we don't need custom logic,
             but we should verify if default theme is applied.
             Since we override StyleKey, we lose default SplitView theme unless we copy it.
             Or we can rely on standard properties.
             Let's copy the minimal SplitView template. -->

        <!-- Simplified SplitView Template aligning with standard structure.
             This relies on 'Overlay' mode logic for layout, but we manually handle the visual transitions
             since SplitView is templated.
             We ensure we use Panel for PaneRoot to allow SplitView logic to measure it. -->
        <Setter Property="Template">
            <ControlTemplate>
                <Grid>
                    <!-- Content -->
                    <ContentPresenter Name="PART_ContentPresenter"
                                      Content="{TemplateBinding Content}"
                                      ContentTemplate="{TemplateBinding ContentTemplate}" />

                    <!-- Overlay (for Overlay display mode only - hidden for Inline mode) -->
                    <Rectangle Name="Overlay"
                               Fill="#80000000"
                               IsVisible="False"
                               IsHitTestVisible="False"
                               Opacity="0" />

                    <!-- Pane -->
                    <!-- We use PART_PaneRoot so SplitView logic (measuring OpenPaneLength) works. -->
                    <Grid Name="PART_PaneRoot"
                          Background="{TemplateBinding PaneBackground}"
                          Width="{TemplateBinding OpenPaneLength}"
                          HorizontalAlignment="Left"
                          ZIndex="100">
                        <Grid.RenderTransform>
                            <TranslateTransform X="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=OpenPaneLength, Converter={x:Static controls:DrawerConverters.NegativeConverter}}" />
                        </Grid.RenderTransform>
                        <Grid.Transitions>
                            <Transitions>
                                <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.3" Easing="CubicEaseOut" />
                            </Transitions>
                        </Grid.Transitions>

                        <ContentPresenter Name="PART_PanePresenter"
                                          Content="{TemplateBinding Pane}"
                                          ContentTemplate="{TemplateBinding PaneTemplate}" />
                    </Grid>
                </Grid>
            </ControlTemplate>
        </Setter>


        <Style Selector="^[IsPaneOpen=True] /template/ Grid#PART_PaneRoot">
             <Setter Property="RenderTransform" Value="translateX(0)" />
        </Style>

    </ControlTheme>
</ResourceDictionary>

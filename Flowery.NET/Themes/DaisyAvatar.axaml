<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="clr-namespace:Flowery.Controls;assembly=Flowery.NET">

    <Design.PreviewWith>
        <Border Padding="20">
             <StackPanel Spacing="10" Orientation="Horizontal">
                 <controls:DaisyAvatar>
                     <Image Source="avares://Flowery.NET.Gallery/Assets/avalonia-logo.ico" />
                 </controls:DaisyAvatar>
                 <controls:DaisyAvatar IsRounded="False">
                     <TextBlock Text="SQ" VerticalAlignment="Center" HorizontalAlignment="Center" Background="#ccc" />
                 </controls:DaisyAvatar>
                 <controls:DaisyAvatar Size="Large" Status="Online">
                     <Border Background="Orange" />
                 </controls:DaisyAvatar>
             </StackPanel>
        </Border>
    </Design.PreviewWith>

    <ControlTheme x:Key="{x:Type controls:DaisyAvatar}" TargetType="controls:DaisyAvatar">
        <Setter Property="Width" Value="48" />
        <Setter Property="Height" Value="48" />
        <Setter Property="ClipToBounds" Value="False" />

        <Setter Property="Template">
            <ControlTemplate>
                <Grid>
                    <!-- Avatar Mask/Container -->
                    <Border Name="Mask"
                            Background="{TemplateBinding Background}"
                            CornerRadius="{TemplateBinding Width, Converter={x:Static controls:IndicatorConverters.HalfToCornerRadiusConverter}}"
                            ClipToBounds="True">
                        <ContentPresenter Content="{TemplateBinding Content}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          HorizontalAlignment="Stretch"
                                          VerticalAlignment="Stretch"/>
                    </Border>

                    <!-- Status Indicator -->
                    <Border Name="StatusDot"
                            Width="12" Height="12"
                            CornerRadius="6"
                            BorderThickness="2"
                            BorderBrush="White"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            IsVisible="False"
                            Margin="0,0,0,0">
                         <!-- Positioning depends on status logic. DaisyUI puts it top-right or bottom-right. -->
                    </Border>
                </Grid>
            </ControlTemplate>
        </Setter>

        <!-- IsRounded=False -> Square (Small radius) -->
        <Style Selector="^[IsRounded=False] /template/ Border#Mask">
             <Setter Property="CornerRadius" Value="8" />
        </Style>

        <!-- Sizes -->
        <Style Selector="^[Size=Large]">
            <Setter Property="Width" Value="96" />
            <Setter Property="Height" Value="96" />
        </Style>
        <Style Selector="^[Size=Small]">
            <Setter Property="Width" Value="32" />
            <Setter Property="Height" Value="32" />
        </Style>
        <Style Selector="^[Size=ExtraSmall]">
            <Setter Property="Width" Value="24" />
            <Setter Property="Height" Value="24" />
        </Style>

        <!-- Status -->
        <Style Selector="^[Status=Online] /template/ Border#StatusDot">
             <Setter Property="IsVisible" Value="True" />
             <Setter Property="Background" Value="{DynamicResource DaisySuccessBrush}" />
        </Style>
        <Style Selector="^[Status=Offline] /template/ Border#StatusDot">
             <Setter Property="IsVisible" Value="True" />
             <Setter Property="Background" Value="{DynamicResource DaisyNeutralBrush}" />
        </Style>

    </ControlTheme>
</ResourceDictionary>

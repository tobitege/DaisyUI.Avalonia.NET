<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="clr-namespace:Flowery.Controls;assembly=Flowery.NET">

    <Design.PreviewWith>
        <Border Padding="20">
             <StackPanel Spacing="20" Orientation="Horizontal">
                 <controls:DaisyRadialProgress Value="70" />
                 <controls:DaisyRadialProgress Value="30" Variant="Primary" />
                 <controls:DaisyRadialProgress Value="100" Variant="Accent" Size="Large" />
             </StackPanel>
        </Border>
    </Design.PreviewWith>

    <ControlTheme x:Key="{x:Type controls:DaisyRadialProgress}" TargetType="controls:DaisyRadialProgress">
        <Setter Property="Width" Value="48" />
        <Setter Property="Height" Value="48" />
        <Setter Property="Foreground" Value="{DynamicResource DaisyBaseContentBrush}" />
        <Setter Property="Background" Value="{DynamicResource DaisyBase200Brush}" /> <!-- Track -->
        <Setter Property="Thickness" Value="4" />

        <Setter Property="Template">
            <ControlTemplate>
                <Grid>
                    <!-- Using Arc is easiest. -->
                    <!-- Track -->
                    <Arc Width="{TemplateBinding Width}"
                         Height="{TemplateBinding Height}"
                         StartAngle="0"
                         SweepAngle="360"
                         Stroke="{TemplateBinding Background}"
                         StrokeThickness="{TemplateBinding Thickness}" />

                    <!-- Indicator -->
                    <!-- We need to bind SweepAngle to Value/Max.
                         Arc SweepAngle is in degrees.
                         Formula: (Value - Min) / (Max - Min) * 360.
                         We need a converter. -->
                    <Arc Name="PART_Indicator"
                         Width="{TemplateBinding Width}"
                         Height="{TemplateBinding Height}"
                         StartAngle="-90"
                         Stroke="{TemplateBinding Foreground}"
                         StrokeThickness="{TemplateBinding Thickness}"
                         StrokeLineCap="Round">
                         <Arc.SweepAngle>
                             <MultiBinding Converter="{x:Static controls:RadialConverters.RangeToSweepConverter}">
                                 <Binding Path="Value" RelativeSource="{RelativeSource TemplatedParent}" />
                                 <Binding Path="Minimum" RelativeSource="{RelativeSource TemplatedParent}" />
                                 <Binding Path="Maximum" RelativeSource="{RelativeSource TemplatedParent}" />
                             </MultiBinding>
                         </Arc.SweepAngle>
                    </Arc>

                    <!-- Text Content (Optional, usually % or icon) -->
                    <TextBlock Text="{Binding Value, RelativeSource={RelativeSource TemplatedParent}, StringFormat='{}{0}%'}"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               FontSize="10"
                               FontWeight="Bold"/>
                </Grid>
            </ControlTemplate>
        </Setter>

        <!-- Variants -->
        <Style Selector="^[Variant=Primary]">
             <Setter Property="Foreground" Value="{DynamicResource DaisyPrimaryBrush}" />
        </Style>
        <Style Selector="^[Variant=Secondary]">
             <Setter Property="Foreground" Value="{DynamicResource DaisySecondaryBrush}" />
        </Style>
        <Style Selector="^[Variant=Accent]">
             <Setter Property="Foreground" Value="{DynamicResource DaisyAccentBrush}" />
        </Style>

        <!-- Sizes -->
        <Style Selector="^[Size=Large]">
            <Setter Property="Width" Value="80" />
            <Setter Property="Height" Value="80" />
            <Setter Property="Thickness" Value="8" />
            <Setter Property="FontSize" Value="14" />
        </Style>
        <Style Selector="^[Size=Small]">
            <Setter Property="Width" Value="32" />
            <Setter Property="Height" Value="32" />
            <Setter Property="Thickness" Value="3" />
            <Setter Property="FontSize" Value="8" />
        </Style>

    </ControlTheme>
</ResourceDictionary>

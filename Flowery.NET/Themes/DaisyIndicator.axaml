<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="clr-namespace:Flowery.Controls;assembly=Flowery.NET">

    <Design.PreviewWith>
        <Border Padding="50">
             <controls:DaisyIndicator>
                 <controls:DaisyIndicator.Badge>
                     <controls:DaisyBadge Variant="Primary" Content="99+" />
                 </controls:DaisyIndicator.Badge>
                 <Button Content="Inbox" />
             </controls:DaisyIndicator>
        </Border>
    </Design.PreviewWith>

    <ControlTheme x:Key="{x:Type controls:DaisyIndicator}" TargetType="controls:DaisyIndicator">
        <Setter Property="ClipToBounds" Value="False" />
        <Setter Property="Template">
            <ControlTemplate>
                <Grid ClipToBounds="False">
                    <ContentPresenter Content="{TemplateBinding Content}"
                                      ContentTemplate="{TemplateBinding ContentTemplate}" />

                    <ContentPresenter Content="{TemplateBinding Badge}"
                                      HorizontalAlignment="{TemplateBinding BadgeHorizontalAlignment}"
                                      VerticalAlignment="{TemplateBinding BadgeVerticalAlignment}">
                         <!-- We need to offset the badge so it sits on the corner.
                              DaisyUI uses translate(-50%, -50%) typically for top-left, etc.
                              Or translate(50%, -50%) for top-right.

                              We can use a RenderTransform bound to alignment?
                              Or hardcode typical variants.

                              Let's assume default is TopRight.
                              Translate(50%, -50%). -->
                         <ContentPresenter.RenderTransform>
                             <TranslateTransform X="{Binding $parent[ContentPresenter].Bounds.Width, Converter={x:Static controls:IndicatorConverters.HalfConverter}}"
                                                 Y="{Binding $parent[ContentPresenter].Bounds.Height, Converter={x:Static controls:IndicatorConverters.NegativeHalfConverter}}"/>
                         </ContentPresenter.RenderTransform>
                    </ContentPresenter>
                </Grid>
            </ControlTemplate>
        </Setter>

        <!-- We need to adjust Transform based on Alignment.
             Ideally use a Converter that takes Alignment and Size.
             For MVP, let's hardcode the most common case (TopRight) or try to support basic corners via Styles?

             Actually, pure XAML calc is hard.
             DaisyUI .indicator-item is absolute positioned.
             Avalonia doesn't support % translation easily without binding to bounds.

             Let's implement a simple converter for offsets. -->

    </ControlTheme>
</ResourceDictionary>
